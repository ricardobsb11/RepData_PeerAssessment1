---
title: "Project1.Rmd"
author: "Ricardo Martins"
date: "October 5, 2018"
output: html_document
---

```{r,echo=FALSE}
setwd("/home/ricardo/Documents/cursos/coursera")
library(plyr)
library(dplyr)
library(ggplot2)
```

## Reproducible Research

### Loading and preprocessing the data
```{r, echo=TRUE}
df = read.csv("activity.csv")
str(df)
# converting the format from date coloumn to date:
df$date <-  as.Date(df$date, format = "%Y-%m-%d")
class(df$date)
```
### some visualizations from the data

```{r, echo=TRUE}
head(df)
summary(df)
```
### What is mean total number of steps taken per day?
```{r, echo=TRUE}
df_day <-  ddply(df,~date,summarise,total = sum(steps),mean=mean(steps))
```
### plotting the histogram
```{r, echo=TRUE}
hist(df_day$total,breaks = 60,main = "Histogram of number of steps by day",xlab = "Number of Steps",col = "cyan")
```

### The mean and median of the total number of steps taken per day
```{r,echo=TRUE}
mean(df$steps,na.rm = TRUE)
median(df$steps,na.rm = TRUE)
```
### What is the average daily activity pattern?
```{r,echo=TRUE}
# mean and median from the steps taken each day
df_mean <-  ddply(df,~date,summarise,mean = mean(steps),median = median(steps))
# Time series plot of the average number of steps taken
qplot(x=date, y=mean,data=df_mean, na.rm=TRUE,main="Time series plot\n of the average number of steps taken",
      xlab="Date", ylab="Steps by day (Mean)") + stat_smooth(colour="red")
```

### summarizing the data by day:
```{r,echo=TRUE}
df_day2 <-  ddply(df,~date,summarise,total = sum(steps),mean=mean(steps))
head(df_day2,3)
```

```{r, echo=TRUE}
# The 5-minute interval that, on average, contains the maximum number of steps
interval_maxmean <- ddply(df,~interval,summarise,mean = mean(steps,na.rm = TRUE))%>%filter(mean==max(mean))
interval_maxmean

# interval that contains the maximum number of steps, on average
print(paste("The interval which contains the maximum number of steps, on average is the interval",interval_maxmean$interval),quote = FALSE)
```

### Imputing missing values
```{r, echo=TRUE}
cat(print("Total of missing values in the steps variable:"),sum(is.na(df$steps)))
```

### Strategy for filling in all of the missing values in the dataset: I decided to imputing the generalsteps mean into the steps missing values.

```{r, echo=TRUE}
df$steps[is.na(df$steps)] <-  round(mean(df$steps,na.rm=TRUE))   
sum(is.na(df$steps)) # the missing values were removed
```

Creating a new dataset that is equal to the original dataset but with the missing data filled in:
```{r, echo=TRUE}
df2 <- df
head(df2,3)
```

```{r, echo=TRUE}
# summarizing the data by day
df2_day <-  ddply(df2,~date,summarise,total = sum(steps),mean=mean(steps))
hist(df2_day$total,breaks = 60,main = "Histogram of number total of steps by day",xlab = "Number of Steps",col = "magenta")
```

Mean and median of total number of steps taken per day after filling NA's values:
```{r, echo=TRUE}
cat(print("Mean:"),mean(df2$steps))
cat(print("Median:"),median(df2$steps))
```
In this case, the imputing of missing values with the mean value impacted on the estimates of the total daily number of steps:
```{r, echo=TRUE}
sum(df_day2$total,na.rm = TRUE)
sum(df2_day$total)
cat(print("The impact of imputing missing values:"),sum(df2_day$total)-sum(df_day2$total,na.rm = TRUE), "more steps.")
```
### Are there differences in activity patterns between weekdays and weekends?
#### creating a new coloumn in the original dataset with the "weekday" or "weekend" values:
```{r, echo=TRUE}
df2$day <- ifelse((weekdays(df2$date) == "sÃ¡bado") | (weekdays(df2$date) == "domingo"),"weekend","weekday")
table(df2$day)
# converting the new coloumn in factor 
df2$day = as.factor(df2$day)
str(df2)
# subseting the dataset
df2_weekday <- df2[(df2$day)=="weekday",]
df2_weekend <- df2[(df2$day)=="weekend",]
```

```{r, echo=TRUE}
weekday<-ddply(df2_weekday,~interval,summarise,total=sum(steps))
weekend<-ddply(df2_weekend,~interval,summarise,total=sum(steps))
```

Panel plot containing a time series plot of the 5-minute interval
```{r, echo=TRUE}
par(mfrow=c(2,1)) 
qplot(x=interval, y=total,data=weekday,main="Time series plot\n of number of steps taken\n weekdays")+ stat_smooth(colour="red")
qplot(x=interval, y=total,data=weekend,main="Time series plot\n of number of steps taken\n weekends")+ stat_smooth(colour="red")
```


